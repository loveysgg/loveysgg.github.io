<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>春晚红包宕机史，中国互联网技术进步史。腾讯、阿里宕机3年，2019年为何百度挺住了？ | 浪里个男</title>
<meta name="description" content="你期待的，值得等待">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://loveysgg.github.io//favicon.ico?v=1560045081805">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://loveysgg.github.io//styles/main.css">



<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>

<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />



  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://loveysgg.github.io/">
        <img src="https://loveysgg.github.io//images/avatar.png?v=1560045081805" class="site-logo">
        <h1 class="site-title">浪里个男</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            首页
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            归档
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            关于
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      你期待的，值得等待
    </div>
    <div class="site-footer">
      Powered by <a href"https://blog.niubo.ren"_blank">浪里个男</a> | <a class="rss" href="https://loveysgg.github.io//atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">春晚红包宕机史，中国互联网技术进步史。腾讯、阿里宕机3年，2019年为何百度挺住了？</h2>
            <div class="post-date">2019-02-05</div>
            
            <div class="post-content">
              <p>这个话题必须值得写下。因为这是史上第一个扛住央视春晚流量的公司。</p>
<p>技术不用说，站在自己主观角度说一句：</p>
<p>首次参加春晚，还没有像阿里那样双十一的模拟考，百度没什么好黑的，百度的技术有多牛逼，百度的产品就可以有多差。</p>
<p>百度如果宕机了，有人就会说：技术是吹的。</p>
<p>百度没宕机，有人就会说：流量没起来。你有微信那体量？</p>
<p>百度黑子黑百度，我想起了一句话：下雨天打孩子，闲着也是闲着。</p>
<p>最烦特么的“身边党”：我身边没几个人用百度去抢红包——你身边才几个人啊？春晚有11亿+观众你知道不？百度App日活破3亿（去年底才1.6亿）还不能说明问题？（估计这帮人又得说，百度公布的数据是假的……）</p>
<p>还有人说“现在为了几毛钱去下载App的人已经很少了”，你看不上不代表别人看不上啊，看看趣头条、拼多多们的火爆吧，你以为人家去抢红包真是为了发家致富？</p>
<p>有些人啊，总是先入为主，看到什么，就觉得这个世界是什么。</p>
<p>罗振宇在2019年的跨年演讲提到了这样一个细节。</p>
<p>得到APP原本打算在春晚投放广告，但是他被曾经的广告部老领导劝住了，因为春晚广告有一个不成文的规定：</p>
<p>要想在春晚打广告，产品日活得先过亿。原因是，用户量过低，技术很难支撑起庞大的流量。</p>
<p>新年钟声越来越近了，红包集福分X亿活动全国火热，也意味着一年一度的“春晚红包大战”越发临近了。即将到来的猪年春晚，百度拿下春晚红包合作，那么如今日活已有1.6亿的百度APP能否撑住“史上最大红包流量”？</p>
<p>可能的答案是，技术强如百度，应对瞬间涌入巨大流量或许也要遭遇短时间宕机的“幸福烦恼”。</p>
<p>春晚红包宕机史，也是中国互联网技术进步史。</p>
<p>中国互联网说大流量，一般我们会说双十一晚上零时全民网购，全国人民一起抢购突发流量是大流量，还有就是春运12306抢票的流量。而实际上，春晚抢红包的流量才是终极BOSS。</p>
<p>我们看下数据。微信是装机量最大的APP了，日活高峰是9.5亿，支付宝这种日活不过2.3亿，而春晚是在短短几分钟内，有10多亿用户同时发出需求。这个强度非常之高。</p>
<p>2015年除夕当天，腾讯宕机1小时。</p>
<p>2016年，支付宝拿下了春晚合作机会。除夕夜，支付宝出现偶尔宕机。</p>
<p>2018年春晚，淘宝提前推导了各种极端情况，在2017年双十一基础上再扩容3倍。结果春晚当晚登录的实际峰值超过了2017年双十一的15倍，尤其新用户的瞬时登录更是完全超出预料，经受过双十一洗礼的阿里服务器还是宕机了。</p>
<p>前有A、T的前车之鉴，百度今年能不能扛住，也是受到很多关注。</p>
<p>事实上，当晚第一轮摇一摇红包活动结束后，截至21:00，全球观众参与百度APP红包互动就已经达到了92亿次，而这才刚刚开始。史无前例的9亿红包数额、还有2019年智能机进一步普及，互联网加速下沉县城、乡镇、农村的趋势，果然都让2019人们的红包热情爆发得更加汹涌。</p>
<p>这些还不是全部。</p>
<p>任何红包类、抽奖类活动还会有一个灰色的影子参与其中，这就是中国互联网的黑产用户，中国薅羊毛党手里掌握大量虚拟资源，拼多多号称一夜损失200亿就是它们干的，它们可以在短时间内产生巨大流量，这部分流量叠加正常流量，也进一步加大了服务器的压力。</p>
<p>另外，因为抢红包这个东西，是有一个流程的，涉及很多外部服务，百度自己的服务器只是其中一个环节。</p>
<p>没下载的用户下载百度APP，没注册的注册，注册的收短信要通过电信运营商，所有网络需求都要通过硬件。APP市场的服务器，电信运营商的网络，机房、光纤等硬件，有一个环节容量不够，都可能导致宕机。</p>
<p>事实上，春晚当天百度的第一轮红包互动之后，苹果应用商店、华为、小米、三星几大应用商店全部挂掉，其中苹果应用商店长达12分钟不能访问，今年的流量显然远超预期。在春晚直播期间，全球观众参与百度APP红包互动活动次数达208亿次！</p>
<p>但是，百度扛住了。</p>
<p>知乎上对于百度有一个声音，当然，我觉得也可以参考下：</p>
<p>首先定义什么叫扛住，</p>
<p>客户端很多请求失败了，但是有祝福语补充保证用户体验，</p>
<p>后台服务load balance基本上打满了，多了就降级，</p>
<p>所有请求，到了后端的，就寄到日志里，有问题的后续追日志</p>
<p>这反正谁也不知道是不是足量发放了红包，谁也不知道数对不对</p>
<p>如果扛住只是说，用户端体验，那应该算不影响体验吧</p>
<p>好多人看，补充一些，其中有些技术还是很牛逼的</p>
<p>1，红包存量的管理，这是个分布式一致性问题，猜测是分库，和内部的一致性存储系统，消息队列系统的功劳</p>
<p>2，抗流量相对简单，就是堆机器，但是后台离线实时数据计算，这么大数据量，不容易</p>
<p>3，构建了不错的流量漏斗，每一个层级都挡住了一些</p>
<p>4，全场产品降级为红包让路，这个能短期能搞定越是大厂约不容易</p>
<p>相对做得聪明的一点，微信和阿里，印象是直接对接了后端支付系统，所以红包入库很容易拖垮整个系统。百度比较聪明，就先只记录数字，然后在存储到支付。实话说，昨天抢红包的时候，领取页面是挂了的，后来领取页面好了，但也不能直接取钱</p>
<p>不管怎么样，我们甚至可以预测，春晚的流量规模，未来可能正是5G和物联网时代的“常规需求”，提前排兵布阵，百利无一害。</p>
<p>《圣经：新约路加福音》里面有这样一段叙述。耶稣对众人说：“你们要努力进窄门。我告诉你们：将来有许多人想要进去，却是不能。”</p>
<p>“窄门”的意义是，那些寻求进入窄门的人必须经过斗争和压力，就像一个跑步运动员紧张冲向终点线，所有的肌肉拉紧，并付出他的所有努力。</p>
<p>对中国互联网巨头来说，春晚红包就像是一道“窄门”，只有真正走过“窄门”，才能历经洗礼，应对未来。这样的洗礼，当然也是另一种幸福。</p>
<p>加油，中国互联网。</p>

            </div>
            
            
              <div class="next-post">
                <div class="next">下一篇</div>
                <a href="https://loveysgg.github.io//post/wxhb">
                  <h3 class="post-title">
                    用技术手段通俗告诉你，怎么更快抢到红包
                  </h3>
                </a>
              </div>
            

            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>

<script type="application/javascript">

AOS.init();

hljs.initHighlightingOnLoad()

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>




  </body>
</html>
